var encoded=null,elementId=null;function randomPassword(a){for(var b="",c=0;c<a;c++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".charAt(Math.floor(Math.random()*62));return b} function encryptFormText(a){if(!a){if(document.form.key.value.length==0){alert("Please specify a key with which to encrypt the message.");return}if(document.form.passwd.value.length==0){alert("No plain text to encrypt! Please enter or paste plain text in the "+a+" field above.");return}}if(document.form.key.value.length!=0&&document.form.passwd.value.length!=0){encoded=GibberishAES.enc(document.form.passwd.value,document.form.key.value);document.form.passwd.value=encoded;try{for(var b=document.getElementsByTagName("form"), c=0;c<b.length;c++)if(b[c].name)try{document.forms[c].Show.disabled=false;if(a)document.forms[c].Save.disabled=true;document.forms[c].key.value=""}catch(d){}}catch(e){alert("ERR: "+e)}elementId=randomPassword(8);encoded=encoded.replace(/\n/g,"")}else alert(document.form.passwd.type+" saved")} function genSampleCode(){document.encryptedCode.text.value="";var a=document.getElementById("encryptedTest");a.innerHTML="";if(!(encoded==""||encoded==null||elementId==""||elementId==null))if(document.encryptedCode.codeType[0].checked){var b='<div id="'+elementId+'" title="'+encoded+'">',c="<a href=\"javascript:decryptText('"+elementId+"')\">Show encrypted text</a>",d="</div>";document.encryptedCode.text.value=b+"\n\t"+c+"\n"+d;a.innerHTML=b+c+d}else if(document.encryptedCode.codeType[1].checked){b= "<a href=\"javascript:decryptText('"+elementId+"')\">Show encrypted text</a>";c="<br />\n<br />";d='There is <em><span id="'+elementId+'" title="'+encoded+'">hidden text</span></em> here';document.encryptedCode.text.value=b+"\n"+c+"\n"+d;a.innerHTML=b+c+d}else if(document.encryptedCode.codeType[2].checked){b='This is encrypted: <span id="'+elementId+'" title="'+encoded+'"><a href="javascript:decryptText(\''+elementId+"')\">***</a></span>";document.encryptedCode.text.value=b;a.innerHTML=b}else if(document.encryptedCode.codeType[3].checked){b= '<form> <input type="text" id="'+elementId+'" name="'+formName+'" value="'+encoded+'" /> </form>';document.encryptedCode.text.value=b+"\n\t";a.innerHTML=b}} function decryptFormText(){if(document.form.key.value.length==0)alert("Please specify a key with which to decrypt the message.");else if(document.form.passwd.value.length==0)alert("No cipher text to decrypt! Please enter or paste cipher text in the field above.");else try{var a=GibberishAES.dec(document.form.passwd.value,document.form.key.value);document.form.passwd.text.value=a}catch(b){document.form.passwd.value.match(/.+=$/)?alert("Invalid key"):alert("Can't decrypt "+document.form.passwd.text.value+ " with that key")}}function gup(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.location.href);return a==null?"":a[1]}function load(){document.form.Show.disabled=true}function clearForm(){document.form.key.value="";document.form.passwd.value="";document.form.Show.disabled=true;document.form.Save.disabled=false};
